{"version":3,"file":"prisma-payment-repository.js","sources":["infrastructure/data/prisma/prisma-payment-repository.ts"],"sourceRoot":"/","sourcesContent":["import { PaymentRepositoryPort } from \"../../../application/ports/payment-repository\";\nimport { Payment, PrismaClient } from \".prisma/client\";\nimport prisma from \"./prisma\";\n\nconst createPaymentRepositoryDb = (\n  prismaClient: PrismaClient\n): PaymentRepositoryPort => {\n  return {\n    create: async (paymentData) => {\n      const payment = await prismaClient.payment.create({\n        data: paymentData,\n      });\n      return payment;\n    },\n\n    updatePayment: async (data: Partial<Payment>, id) => {\n      if (!id && !data.refId) {\n        throw new Error(\"Platbu nelze aktualizovat chybÃ­ ID nebo REFID.\");\n      }\n\n      try {\n        if (data.refId) {\n          const updatedPayment = await prisma.payment.update({\n            where: { refId: data.refId },\n            data,\n          });\n\n          return updatedPayment;\n        }\n\n        if (id) {\n          const updatedPayment = await prisma.payment.update({\n            where: { id },\n            data,\n          });\n\n          return updatedPayment;\n        }\n      } catch (error) {\n        console.log(\"prismaPaymentRepositoryDb - updatePayment error\", error);\n        throw new Error(\"Platbu nelze aktualizovat.\");\n      }\n    },\n    findByExternalId: async (transactionId: string) => {\n      const payment = await prismaClient.payment.findUnique({\n        where: { transactionId },\n      });\n\n      return payment;\n    },\n  };\n};\n\nconst paymentRepositoryDb = createPaymentRepositoryDb(prisma);\nexport default paymentRepositoryDb;\n"],"names":[],"mappings":";;;;;;;AAEA,sDAA8B;AAE9B,MAAM,yBAAyB,GAAG,CAChC,YAA0B,EACH,EAAE;IACzB,OAAO;QACL,MAAM,EAAE,KAAK,EAAE,WAAW,EAAE,EAAE;YAC5B,MAAM,OAAO,GAAG,MAAM,YAAY,CAAC,OAAO,CAAC,MAAM,CAAC;gBAChD,IAAI,EAAE,WAAW;aAClB,CAAC,CAAC;YACH,OAAO,OAAO,CAAC;QACjB,CAAC;QAED,aAAa,EAAE,KAAK,EAAE,IAAsB,EAAE,EAAE,EAAE,EAAE;YAClD,IAAI,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC;gBACvB,MAAM,IAAI,KAAK,CAAC,gDAAgD,CAAC,CAAC;YACpE,CAAC;YAED,IAAI,CAAC;gBACH,IAAI,IAAI,CAAC,KAAK,EAAE,CAAC;oBACf,MAAM,cAAc,GAAG,MAAM,gBAAM,CAAC,OAAO,CAAC,MAAM,CAAC;wBACjD,KAAK,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,KAAK,EAAE;wBAC5B,IAAI;qBACL,CAAC,CAAC;oBAEH,OAAO,cAAc,CAAC;gBACxB,CAAC;gBAED,IAAI,EAAE,EAAE,CAAC;oBACP,MAAM,cAAc,GAAG,MAAM,gBAAM,CAAC,OAAO,CAAC,MAAM,CAAC;wBACjD,KAAK,EAAE,EAAE,EAAE,EAAE;wBACb,IAAI;qBACL,CAAC,CAAC;oBAEH,OAAO,cAAc,CAAC;gBACxB,CAAC;YACH,CAAC;YAAC,OAAO,KAAK,EAAE,CAAC;gBACf,OAAO,CAAC,GAAG,CAAC,iDAAiD,EAAE,KAAK,CAAC,CAAC;gBACtE,MAAM,IAAI,KAAK,CAAC,4BAA4B,CAAC,CAAC;YAChD,CAAC;QACH,CAAC;QACD,gBAAgB,EAAE,KAAK,EAAE,aAAqB,EAAE,EAAE;YAChD,MAAM,OAAO,GAAG,MAAM,YAAY,CAAC,OAAO,CAAC,UAAU,CAAC;gBACpD,KAAK,EAAE,EAAE,aAAa,EAAE;aACzB,CAAC,CAAC;YAEH,OAAO,OAAO,CAAC;QACjB,CAAC;KACF,CAAC;AACJ,CAAC,CAAC;AAEF,MAAM,mBAAmB,GAAG,yBAAyB,CAAC,gBAAM,CAAC,CAAC;AAC9D,kBAAe,mBAAmB,CAAC","debug_id":"99e37eda-2a6b-5e45-9fac-33b12e918138"}