{"version":3,"file":"procedure-controller.js","sources":["infrastructure/controllers/procedure-controller.ts"],"sourceRoot":"/","sourcesContent":["// infrastructure/controllers/procedure-controller.ts\nimport { ControllerFunction } from \"@/adapters/express/make-express-callback\";\nimport { ProcedureCreateData } from \"../../application/ports/procedure-repository\";\nimport addOrUpdateProcedureUseCase, {\n  AddOrUpdateProcedureUseCaseType,\n} from \"../../application/use-cases/procedures/add-or-update-procedure\";\nimport getProceduresUseCase, {\n  GetProceduresUseCaseType,\n} from \"../../application/use-cases/procedures/get-procedures\";\nimport deleteProcedureUseCase, {\n  DeleteProcedureUseCaseType,\n} from \"../../application/use-cases/procedures/delete-procedure\";\n\ntype AddOrUpdateProcedureControllerType = {\n  params: { visitId: string };\n  body?: {};\n};\ntype GetProceduresControllerType = {\n  params: { visitId: string };\n};\ntype DeleteProcedureControllerType = {\n  params: { id: string };\n};\n\nexport const createProcedureController = (dependencies: {\n  getProceduresUseCase: GetProceduresUseCaseType;\n  addOrUpdateProcedureUseCase: AddOrUpdateProcedureUseCaseType;\n  deleteProcedureUseCase: DeleteProcedureUseCaseType;\n}) => {\n  const getProceduresController: ControllerFunction<\n    GetProceduresControllerType\n  > = async (httpRequest) => {\n    try {\n      const visitId = httpRequest.params.visitId;\n      const result = await dependencies.getProceduresUseCase.execute(visitId);\n\n      return { statusCode: 200, body: result };\n    } catch (error: any) {\n      console.error(\"getProceduresController\", error);\n      return { statusCode: 500, body: { error: error.message } };\n    }\n  };\n  const deleteProcedureController: ControllerFunction<\n    DeleteProcedureControllerType\n  > = async (httpRequest) => {\n    try {\n      const procedureId = httpRequest.params.id;\n      const result = await dependencies.deleteProcedureUseCase.execute(\n        procedureId\n      );\n\n      return { statusCode: 200, body: result };\n    } catch (error: any) {\n      console.error(\"deleteProcedureController\", error);\n      return { statusCode: 500, body: { error: error.message } };\n    }\n  };\n\n  const addOrUpdateProcedureController: ControllerFunction<\n    AddOrUpdateProcedureControllerType\n  > = async (httpRequest) => {\n    try {\n      const visitId = httpRequest.params.visitId;\n      const procedureData: ProcedureCreateData = {\n        ...httpRequest.body,\n        visitId,\n        userId: httpRequest.userId,\n      };\n\n      const result = await dependencies.addOrUpdateProcedureUseCase.execute(\n        procedureData\n      );\n\n      return { statusCode: 201, body: result };\n    } catch (error: any) {\n      console.error(\"addOrUpdateProcedureController\", error);\n      return { statusCode: 400, body: { error: error.message } };\n    }\n  };\n\n  return {\n    getProceduresController,\n    addOrUpdateProcedureController,\n    deleteProcedureController,\n  };\n};\n\nconst procedureController = createProcedureController({\n  getProceduresUseCase,\n  addOrUpdateProcedureUseCase,\n  deleteProcedureUseCase,\n});\n\nexport default procedureController;\n"],"names":[],"mappings":";;;;;;;;AAGA,6HAEwE;AACxE,2GAE+D;AAC/D,+GAEiE;AAa1D,MAAM,yBAAyB,GAAG,CAAC,YAIzC,EAAE,EAAE;IACH,MAAM,uBAAuB,GAEzB,KAAK,EAAE,WAAW,EAAE,EAAE;QACxB,IAAI,CAAC;YACH,MAAM,OAAO,GAAG,WAAW,CAAC,MAAM,CAAC,OAAO,CAAC;YAC3C,MAAM,MAAM,GAAG,MAAM,YAAY,CAAC,oBAAoB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;YAExE,OAAO,EAAE,UAAU,EAAE,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;QAC3C,CAAC;QAAC,OAAO,KAAU,EAAE,CAAC;YACpB,OAAO,CAAC,KAAK,CAAC,yBAAyB,EAAE,KAAK,CAAC,CAAC;YAChD,OAAO,EAAE,UAAU,EAAE,GAAG,EAAE,IAAI,EAAE,EAAE,KAAK,EAAE,KAAK,CAAC,OAAO,EAAE,EAAE,CAAC;QAC7D,CAAC;IACH,CAAC,CAAC;IACF,MAAM,yBAAyB,GAE3B,KAAK,EAAE,WAAW,EAAE,EAAE;QACxB,IAAI,CAAC;YACH,MAAM,WAAW,GAAG,WAAW,CAAC,MAAM,CAAC,EAAE,CAAC;YAC1C,MAAM,MAAM,GAAG,MAAM,YAAY,CAAC,sBAAsB,CAAC,OAAO,CAC9D,WAAW,CACZ,CAAC;YAEF,OAAO,EAAE,UAAU,EAAE,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;QAC3C,CAAC;QAAC,OAAO,KAAU,EAAE,CAAC;YACpB,OAAO,CAAC,KAAK,CAAC,2BAA2B,EAAE,KAAK,CAAC,CAAC;YAClD,OAAO,EAAE,UAAU,EAAE,GAAG,EAAE,IAAI,EAAE,EAAE,KAAK,EAAE,KAAK,CAAC,OAAO,EAAE,EAAE,CAAC;QAC7D,CAAC;IACH,CAAC,CAAC;IAEF,MAAM,8BAA8B,GAEhC,KAAK,EAAE,WAAW,EAAE,EAAE;QACxB,IAAI,CAAC;YACH,MAAM,OAAO,GAAG,WAAW,CAAC,MAAM,CAAC,OAAO,CAAC;YAC3C,MAAM,aAAa,GAAwB;gBACzC,GAAG,WAAW,CAAC,IAAI;gBACnB,OAAO;gBACP,MAAM,EAAE,WAAW,CAAC,MAAM;aAC3B,CAAC;YAEF,MAAM,MAAM,GAAG,MAAM,YAAY,CAAC,2BAA2B,CAAC,OAAO,CACnE,aAAa,CACd,CAAC;YAEF,OAAO,EAAE,UAAU,EAAE,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;QAC3C,CAAC;QAAC,OAAO,KAAU,EAAE,CAAC;YACpB,OAAO,CAAC,KAAK,CAAC,gCAAgC,EAAE,KAAK,CAAC,CAAC;YACvD,OAAO,EAAE,UAAU,EAAE,GAAG,EAAE,IAAI,EAAE,EAAE,KAAK,EAAE,KAAK,CAAC,OAAO,EAAE,EAAE,CAAC;QAC7D,CAAC;IACH,CAAC,CAAC;IAEF,OAAO;QACL,uBAAuB;QACvB,8BAA8B;QAC9B,yBAAyB;KAC1B,CAAC;AACJ,CAAC,CAAC;AA7DW,QAAA,yBAAyB,6BA6DpC;AAEF,MAAM,mBAAmB,GAAG,IAAA,iCAAyB,EAAC;IACpD,oBAAoB,EAApB,wBAAoB;IACpB,2BAA2B,EAA3B,iCAA2B;IAC3B,sBAAsB,EAAtB,0BAAsB;CACvB,CAAC,CAAC;AAEH,kBAAe,mBAAmB,CAAC","debug_id":"535a074f-aab3-521d-a70d-82a6f50ce5bd"}