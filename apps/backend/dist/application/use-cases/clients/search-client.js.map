{"version":3,"file":"search-client.js","sources":["application/use-cases/clients/search-client.ts"],"sourceRoot":"/","sourcesContent":["import { ClientRepositoryPort } from \"../../../application/ports/client-repository\";\nimport clientRepositoryDb from \"../../../infrastructure/data/prisma/prisma-client-repository\";\nimport { TeamMemberRepositoryPort } from \"../../../application/ports/team-member-repository\";\nimport teamMemberRepositoryDb from \"../../../infrastructure/data/prisma/prisma-team-member-repository\";\nimport { ClientWithVisitsAndServices } from \"@/infrastructure/mappers/client-mapper\";\n\nconst createSearchClientsUseCase = (dependencies: {\n  clientRepositoryDb: ClientRepositoryPort;\n  teamMemberRepositoryDb: TeamMemberRepositoryPort;\n}) => {\n  return {\n    execute: async (\n      userId: string,\n      query: string\n    ): Promise<ClientWithVisitsAndServices[]> => {\n      if (!query) {\n        return [];\n      }\n      const teamMember =\n        await dependencies.teamMemberRepositoryDb.findUniqueMember(userId);\n\n      if (!teamMember) {\n        throw Error(\"User has no team assigned.\");\n      }\n\n      const clients = await dependencies.clientRepositoryDb.search(\n        teamMember.teamId,\n        query,\n        userId\n      );\n\n      return clients;\n    },\n  };\n};\n\nconst searchClientsUseCase = createSearchClientsUseCase({\n  clientRepositoryDb,\n  teamMemberRepositoryDb,\n});\n\nexport type SearchClientsUseCaseType = ReturnType<\n  typeof createSearchClientsUseCase\n>;\n\nexport default searchClientsUseCase;\n"],"names":[],"mappings":";;;;;;;AACA,4HAA8F;AAE9F,sIAAuG;AAGvG,MAAM,0BAA0B,GAAG,CAAC,YAGnC,EAAE,EAAE;IACH,OAAO;QACL,OAAO,EAAE,KAAK,EACZ,MAAc,EACd,KAAa,EAC2B,EAAE;YAC1C,IAAI,CAAC,KAAK,EAAE,CAAC;gBACX,OAAO,EAAE,CAAC;YACZ,CAAC;YACD,MAAM,UAAU,GACd,MAAM,YAAY,CAAC,sBAAsB,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;YAErE,IAAI,CAAC,UAAU,EAAE,CAAC;gBAChB,MAAM,KAAK,CAAC,4BAA4B,CAAC,CAAC;YAC5C,CAAC;YAED,MAAM,OAAO,GAAG,MAAM,YAAY,CAAC,kBAAkB,CAAC,MAAM,CAC1D,UAAU,CAAC,MAAM,EACjB,KAAK,EACL,MAAM,CACP,CAAC;YAEF,OAAO,OAAO,CAAC;QACjB,CAAC;KACF,CAAC;AACJ,CAAC,CAAC;AAEF,MAAM,oBAAoB,GAAG,0BAA0B,CAAC;IACtD,kBAAkB,EAAlB,kCAAkB;IAClB,sBAAsB,EAAtB,uCAAsB;CACvB,CAAC,CAAC;AAMH,kBAAe,oBAAoB,CAAC","debug_id":"cfceeef6-d8c8-5edd-b55d-dcf7c00cc178"}